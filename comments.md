Максим, привет! Спасибо за ревью, очень понравилась рекомендация про execute_values из psycopg2. Это правда очень гибко и удобно.

- В STG сделал почасовую загрузку табличек из проекта с data_interval_start/end.
- В DDS сделал заполнение двух таблиц одним файлом, чтобы это происходило в одной транзакции. Столкнулся с неприятным даунтаймом в DDS-слое, пока делал витрину - в dds-ках не было данных, когда мы их полностью обновляли. И кажется, что единая транзакция решает эту проблему. Сделал сенсор в проектном даге, чтобы ждал основные dds-таблички, и оба дага переключил на почасовой запуск. Хотя бы будут синхронизированы)
  - Хотя здесь хорошо как раз подойдёт идемпотентная инкрементная загрузка, чтобы таких даунтаймов не было) как ты и говоришь) делал такую штуку на прошлой работе из монго в постгрес. Но с транзакциями не заморачивался, и из-за этого были определённые беды)
- в CDM сделал загрузку инкрементом по месяцу запуска, чтобы брать из dds только месяц, который обновился. Проверил в эйрфлоу, всё работает)